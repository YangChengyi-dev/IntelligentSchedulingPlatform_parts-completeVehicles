webpackJsonp([50],{"+CyX":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.el-popover {\n\t\tfont-size: 10px;\n\t\tmin-width: 50%;\n\t\tbackground: #303133;\n  \t\tcolor: #fff;\n\t\tmax-width:30%;\n    \tpadding-bottom: 5px!important;\n    \tdisplay: -webkit-box;\n    \toverflow: hidden;\n    \ttext-overflow: ellipsis;\n    \t-webkit-line-clamp: 30;\n    \t-webkit-box-orient: vertical;\n\t\toverflow-y:scroll;\n\t\toverflow-x:hidden;\n}\n.customWidth{\n    \twidth:80%;\n}\n\t/* dialog */\n.menu-dialog-height {\n        height: 65%;\n}\n.el-form-item__content{\n        float: left;\n        margin-left:5%;\n}\ndiv.el-row:nth-child(1) {\n\t\tpadding-left: 5%;\n}\n",""])},"4H24":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.goodsindex[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\tmin-height: 100%;\n\t\tpadding: 15px;\n\t\t-webkit-box-sizing: border-box;\n\t\t        box-sizing: border-box;\n}\n\n\t/* 搜索 */\n.goodsindex-queryInfo[data-v-3f3e4978] {\n\t\tmargin-bottom: 20px;\n\t\tmargin-left: 50%;\n}\n.goodsindex-queryInfo-li-one[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\theight: auto;\n\t\tmargin-left: 200%;\n}\n.goodsindex-queryInfo-li-two[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\theight: auto;\n\t\tmargin-left: 470%;\n}\n.goodsindex-queryInfo-li-three[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\theight: auto;\n\t\tmargin-left: 470%;\n}\n\n\t/* 列表 */\n.goodsindex-list[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\theight: auto;\n\t\tmargin-bottom: 20px;\n}\n\n\t/* 分页 */\n.goodsindex-page-box[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\theight: auto;\n\t\tdisplay: -webkit-box;\n\t\tdisplay: -ms-flexbox;\n\t\tdisplay: flex;\n\t\t-webkit-box-pack: end;\n\t\t    -ms-flex-pack: end;\n\t\t        justify-content: flex-end;\n\t\tmargin-top: 20px;\n}\n.keycode-Info[data-v-3f3e4978] {\n\t\twidth: 100%;\n\t\tmargin-bottom: 15px;\n}\n.keycode-Info-li[data-v-3f3e4978] {\n\t\tmargin-left: 1290%;\n\t\tmargin-top: 15px;\n}\n.upload-demo[data-v-3f3e4978] {\n\t\t/* float: right; */\n        margin-left:25% ;\n}\n.dialog-bottom-button[data-v-3f3e4978] {\n        margin-left: 75%;\n}\n.result-list > div:nth-child(1) > img[data-v-3f3e4978]:nth-child(1) {\n\t\twidth: 49%;\n\t\tdisplay: inline;\n}\n.result-list > div:nth-child(1) > img[data-v-3f3e4978]:nth-child(2){\n\t\twidth: 49%;\n\t\tdisplay: inline;\n}\n.result-dialog[data-v-3f3e4978] .el-dialog{\n        background: #042224;\n}\n",""])},UQZL:function(t,e,a){var n=a("4H24");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("d117fb5e",n,!0)},WvRl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("//Fk"),l=a.n(n),s=a("Dd8w"),i=a.n(s),o=a("mtWM"),r=a.n(o);r.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";var d={data:function(){return{queryInfo:{name:"",type:"",page:1,pageSize:10},dialogVisible:!1,fileList:[],resultTable:[],is_upload:!1,fd:{},headers:{"content-type":"multipart/form-data"},form:{name:"",file:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},searchParam:{file_name:null},si_id:"1",sle_id:"1",si_url:"",ele_url:"",formLabelWidth:"120px",tableData:[],actionURL:"",tempTableData:{task_id:null,file_path:null,file_name:null,create_time:null},deleteTaskIdParams:{task_id:null,task_type:null},resultShowParams:{task_id:null,batch_size:null,batch_num:null},sendRequestParams:{task_id:null},keyCodeShow:!1,resultShow:!1,keyCodeForm:{name:"",remarks:""},keyCodeRules:{name:[{required:!0,message:"请输入文件名称",trigger:"blur"},{min:1,max:5,message:"长度在 1 到 5 个字符",trigger:"blur"}]},keyCodeWidth:"120px"}},created:function(){this.getTask()},methods:{handleClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},sendRequest:function(t){var e=this;r.a.get("http://10.160.24.112:7000/FaultDiagnosis/status",{params:{task_id:t}}).then(function(a){var n=a.data.data;if(0==n){var l=i()({},e.sendRequestParams);l.task_id=t,r.a.post("http://10.160.24.112:7000/FaultDiagnosis/begin",l).then(function(t){e.$message("请求已发送")})}else 2==n?e.$message.success("诊断已完成"):1==n?e.$message("诊断进行中"):e.$message.error("诊断失败")})},checkResult:function(t,e,a){var n=this;r.a.get("http://10.160.24.112:7000/FaultDiagnosis/status",{params:{task_id:a}}).then(function(t){var e=t.data.data;2==e?r.a.get("http://10.160.24.112:7000/FaultDiagnosis/result",{params:{task_id:a}}).then(function(t){n.resultTable=t.data.data,n.resultShow=!0;for(var e=0;e<n.resultTable.length;e++)"无"==n.resultTable[e].level&&(n.resultTable[e].level="");console.log(n.resultTable)}):0==e?n.$message("请先开始诊断"):1==e?n.$message("诊断进行中"):n.$message.error("诊断失败")})},downloadFile:function(t){var e=this;r.a.get("http://10.160.24.112:7000/FaultDiagnosis/status",{params:{task_id:t}}).then(function(a){var n=a.data.data;if(2==n){var l=i()({},e.sendRequestParams);l.task_id=t,r.a.post("http://10.160.24.112:7000/FaultDiagnosis/download",l,{responseType:"blob"}).then(function(e){console.log(e.data);var a=document.createElement("a");a.href=window.URL.createObjectURL(new Blob([e.data])),a.target="_blank";var n="任务"+t+"推断结果.txt";a.download=decodeURI(n),document.body.appendChild(a),a.click(),document.body.removeChild(a)})}else 0==n?e.$message("请先开始诊断"):1==n?e.$message("诊断进行中"):3==n&&e.$message.error("诊断失败")})},onSuccess:function(t,e,a){},deleteTaskId:function(t,e){var a=this;r.a.get("http://10.160.24.112:7000/FaultDiagnosis/status",{params:{task_id:t}}).then(function(n){1==n.data.data?a.$message.error("诊断中无法删除"):(a.tableData=a.tableData.filter(function(t){return t.task_id!=e.task_id}),r.a.get("http://10.160.24.112:7000/FaultDiagnosis/delete",{params:{task_id:t}}).then(function(t){console.log(t.data.message)}),a.$message({message:"任务删除成功",type:"success"}))})},handleCurrentChange:function(t){this.queryInfo.page=t},handleSizeChange:function(t){this.queryInfo.pageSize=t},reset:function(){this.queryInfo.name="",this.getTask()},getTask:function(){var t=this;r.a.get("http://10.160.24.112:7000/FaultDiagnosis/init").then(function(e){t.tableData=e.data.data})},beforeUpload:function(t){var e=this;return new l.a(function(a,n){e.is_upload=!1,console.log(t);var l=Math.random().toString(36).slice(-8);console.log(l);var s=new Date(+new Date+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"");console.log(s);var o=e.form.name;if(""==o)e.message.error("名称不能为空");else{console.log(o);var r=i()({},e.tempTableData);e.actionURL="http://10.160.24.112:7000/FaultDiagnosis/upload?task_id="+l+"&file_name="+o+"&create_time="+s,console.log(e.actionURL),r.task_id=l,r.file_name=o,r.create_time=s,e.tableData.push(r),e.is_upload=!0,e.$nextTick(function(){return a()})}})},submitUpload:function(){this.$refs.upload.submit()},submitForm:function(t){this.$message.success("提交成功"),this.dialogVisible=!1,this.resetFromOther()},addToForm:function(t,e,a){console.log(e),console.log(a)},resetForm:function(t){if(t.name="",t.simulate_network="",t.electrical_distance="",console.log(this.is_upload),this.is_upload){var e=this.tableData[this.tableData.length-1].task_id;r.a.get("http://10.160.24.112:7000/FaultDiagnosis/delete",{params:{task_id:e}}).then(function(t){console.log(t.data.message)}),this.tableData.pop(),this.is_upload=!1}},cellStyle:function(t){var e=t.row,a=t.column;t.rowIndex,t.columnIndex;if("level"===a.property)switch(e.level){case"一级":return{color:"#cc0000"};case"二级":return{color:"#ff8000"};case"三级":return{color:"#ffff00"}}},resetFromOther:function(){this.form.name="",this.form.simulate_network="",this.form.electrical_distance=""},search:function(t){var e=this;if(""==t)this.$message.error("搜索名称不能为空");else{var a=i()({},this.searchParam);a.file_name=t,r.a.post("http://10.160.24.112:7000/FaultDiagnosis/search",a).then(function(t){e.tableData=t.data.data,e.$message.success("查询成功")})}}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"goodsindex"},[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(e){t.dialogVisible=!0}}},[t._v("\n            上传文件\n        ")]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,"before-close":t.handleClose,"custom-class":"menu-dialog-height",close:t.resetFromOther},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{"v-model":t.form}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("el-input",{staticStyle:{width:"180x"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)],1),t._v(" "),a("el-form-item",[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:t.actionURL,multiple:"",accept:".xlsx","before-upload":t.beforeUpload}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传excel文件，且不超过500kb")])])],1),t._v(" "),a("el-form-item",{staticClass:"dialog-bottom-button"},[a("el-button",{on:{click:function(e){t.submitForm(t.form)}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){t.resetForm(t.form)}}},[t._v("重置")])],1)],1)],1),t._v(" "),a("el-row",{staticClass:"goodsindex-queryInfo",attrs:{gutter:20}},[a("el-col",{attrs:{xs:8,sm:6,md:6,lg:4,xl:4}},[a("el-input",{staticClass:"goodsindex-queryInfo-li-one",attrs:{clearable:"",size:"small",placeholder:"请输入项目名称"},model:{value:t.queryInfo.name,callback:function(e){t.$set(t.queryInfo,"name",e)},expression:"queryInfo.name"}})],1),t._v(" "),a("el-col",{attrs:{xs:6,sm:4,md:3,lg:2,xl:2}},[a("el-button",{staticClass:"goodsindex-queryInfo-li-two",attrs:{type:"primary",size:"small"},on:{click:function(e){t.search(t.queryInfo.name)}}},[t._v("搜索")])],1),t._v(" "),a("el-col",{attrs:{xs:6,sm:4,md:3,lg:2,xl:2}},[a("el-button",{staticClass:"goodsindex-queryInfo-li-three",attrs:{type:"primary",size:"small"},on:{click:t.reset}},[t._v("重置")])],1)],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData.slice((t.queryInfo.page-1)*t.queryInfo.pageSize,t.queryInfo.page*t.queryInfo.pageSize),size:"small","default-sort":{prop:"create_time",order:"descending"}}},[a("el-table-column",{attrs:{prop:"file_name",label:"名称",width:"250",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"260",sortable:!0,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small",plain:!0},on:{click:function(a){t.sendRequest(e.row.task_id)}}},[t._v("开始诊断")]),t._v(" "),a("el-button",{attrs:{size:"small",plain:!0,type:"success"},on:{click:function(a){t.checkResult(e.row.simulate_network,e.row.electrical_distance,e.row.task_id)}}},[t._v("查看结果")]),t._v(" "),a("el-button",{attrs:{size:"small",plain:!0,type:"primary"},on:{click:function(a){t.downloadFile(e.row.task_id)}}},[t._v("下载文件")]),t._v(" "),a("el-button",{attrs:{size:"small",plain:!0,type:"danger"},on:{click:function(a){t.deleteTaskId(e.row.task_id,e.row)}}},[t._v("删除任务")])]}}])})],1)],1)],1),t._v(" "),a("el-dialog",{staticClass:"result-dialog",attrs:{visible:t.resultShow,customClass:"customWidth"},on:{"update:visible":function(e){t.resultShow=e}}},[a("el-row",{staticClass:"result-list",attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.resultTable,size:"small","cell-style":t.cellStyle}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center","min-width":"5%"}}),t._v(" "),a("el-table-column",{attrs:{prop:"serial_number",label:"充电桩编号","min-width":"15%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"日期","min-width":"10%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"is_fault",label:"是否故障","min-width":"5%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"type",label:"故障类别","min-width":"10%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"health",label:"健康度","min-width":"15%",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"level",label:"预警级别","min-width":"5%",align:"center"}})],1)],1)],1)],1),t._v(" "),a("el-row",{staticClass:"goodsindex-list",attrs:{gutter:20}},[a("el-col",{staticClass:"goodsindex-page-box",attrs:{span:24}},[a("el-pagination",{attrs:{"current-page":t.queryInfo.page,"page-sizes":[10,20,50,100],"page-size":t.queryInfo.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.tableData.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var u=a("VU/8")(d,c,!1,function(t){a("UQZL"),a("egGL")},"data-v-3f3e4978",null);e.default=u.exports},egGL:function(t,e,a){var n=a("+CyX");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("51eda2cb",n,!0)}});